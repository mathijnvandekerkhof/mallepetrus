# Portainer Stack Configuration for JIPTV Admin Dashboard
# Deploy this as a separate stack named 'jiptv-admin'

version: '3.8'

services:
  jiptv-admin:
    image: jiptv-admin:latest
    container_name: jiptv-admin
    environment:
      # Next.js Configuration
      NODE_ENV: production
      NEXT_PUBLIC_API_URL: https://api.mallepetrus.nl
      NEXT_PUBLIC_APP_NAME: JIPTV Admin Dashboard
      
      # Required for reverse proxy deployment
      HOSTNAME: "0.0.0.0"
      PORT: 3000
      
    networks:
      - proxy_net
      
    restart: unless-stopped
    
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:3000/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s
      
    deploy:
      resources:
        limits:
          memory: 512M
          cpus: '1.0'
        reservations:
          memory: 256M
          cpus: '0.5'
          
    labels:
      # Nginx Proxy Manager labels for admin.mallepetrus.nl
      - "nginx-proxy-manager.enable=true"

networks:
  proxy_net:
    external: true